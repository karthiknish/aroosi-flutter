default_platform(:android)

platform :android do
  desc "Upload Play Store metadata (from repo)"
  lane :upload_metadata do
    package_name = ENV['ANDROID_PACKAGE_NAME'] || 'com.aroosi.mobile'

    unless ENV['GOOGLE_PLAY_SERVICE_ACCOUNT_JSON']&.strip&.length&.positive?
      UI.user_error!("GOOGLE_PLAY_SERVICE_ACCOUNT_JSON environment variable is required to authenticate with Google Play")
    end

    supply(
      package_name: package_name,
      json_key_data: ENV['GOOGLE_PLAY_SERVICE_ACCOUNT_JSON'],
      metadata_path: "./fastlane/metadata/android",
      skip_upload_apk: true,
      skip_upload_aab: true,
      skip_upload_changelogs: false,
      skip_upload_images: true,
      skip_upload_screenshots: true,
      validate_only: false
    )
  end
end
